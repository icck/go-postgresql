# プロジェクト構造

## ディレクトリ構成

```
go-postgresql/
├── cmd/                    # アプリケーションエントリーポイント
│   ├── gorm/main.go       # GORM実装
│   ├── pgx/main.go        # PGX実装
│   └── pq/main.go         # PQ実装
├── config/                 # 共有設定
│   └── env.go             # データベース設定・テストパラメータ
├── init/                   # データベース初期化
│   └── init.sql           # スキーマ・シードデータ
├── data/                   # PostgreSQLデータディレクトリ（Dockerボリューム）
├── docker-compose.yml      # PostgreSQLコンテナ設定
├── benchmark.sh           # 自動ベンチマーク実行スクリプト
├── go.mod                 # Goモジュール定義
└── go.sum                 # Goモジュールチェックサム
```

## アーキテクチャパターン

### コマンドパターン
各データベースライブラリの実装は、専用の`main.go`ファイルを持つ独自の`cmd/`サブディレクトリに分離されています。これにより以下が可能になります：
- 独立した実行とテスト
- 関心の明確な分離
- 実装間の簡単な比較

### 共有設定
すべての実装は`config/env.go`から同じ設定を使用します：
- `InitialUsersCount`: 50,000（シードデータ量）
- `BatchSize`: 5,000（バッチ処理サイズ）
- `UpdateCount`: 5,000（一括更新量）
- `DeleteCount`: 2,500（一括削除量）
- `NewUsersCount`: 10,000（新規データ作成量）

### 一貫したデータモデル
すべての実装で同等のUser構造体を使用：
```go
type User struct {
    ID        int/uint
    Name      string
    Email     string (unique)
    CreatedAt time.Time
}
```

### パフォーマンステストパターン
各実装は同じ操作シーケンスに従います：
1. **Reset** - データベース状態のクリーン
2. **Seed** - 初期データの一括挿入
3. **Read** - カウント操作
4. **Update** - 一括更新操作
5. **Delete** - 一括削除操作
6. **Create** - 新規データのバッチ挿入
7. **Final Read** - 最終状態の確認

## コーディング規約

### 命名規則
- 説明的な変数名を使用：`userCount`、`batchStart`、`seedDuration`
- 実装間で一貫した操作命名
- パフォーマンス要約セクションの明確なラベル付け

### エラーハンドリング
- 重要なデータベースエラーには`log.Fatalf()`を使用
- 重要でないバッチ操作エラーには`log.Printf()`を使用
- データベース接続エラーは常にチェックして処理

### バッチ処理
- すべての一括操作でパフォーマンスのためにバッチングを使用
- 共有設定からの一貫したバッチサイズ
- 長時間実行される操作の進捗レポート

### パフォーマンス測定
- タイミングには`time.Now()`と`time.Since()`を使用
- 個別操作と総実行時間を測定
- すべての実装で標準化されたパフォーマンス要約形式